# SiteCreation

# Passport
Learn Passport

# Sources used
# https://scotch.io/tutorials/easy-node-authentication-setup-and-local

# Paasport Docs
# http://www.passportjs.org/docs/

# Express Passport Error Handling
# https://stackoverflow.com/questions/15711127/express-passport-node-js-error-handling

#ExpressJS with Typescript
# https://dev.to/briandgls/using-typescript-with-express--e0k

# Passport AzureAD Strategy (The new Way, use OIDCStrategy or BearerStrategy) vs. passport-azure-oauth
# https://github.com/AzureAD/passport-azure-ad

# How to use DB to persist users
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-devquickstarts-openidconnect-nodejs

# Refresh Tokens
# https://github.com/fiznool/passport-oauth2-refresh

# Token Formats, Validation, Lifetime, etc.
# https://docs.microsoft.com/en-us/azure/active-directory/develop/v1-id-and-access-tokens

# Access O365 Resources from Node
# https://github.com/OfficeDev/O365-Node-Express-Ejs-Sample-App

# Azure: Migrate MongoDB to Cosmos DB
# https://docs.microsoft.com/en-us/azure/cosmos-db/mongodb-introduction

# Token retrival and AAD Oauth explained
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-protocols-oauth-code

# Calculate expires_on (its delivered as seconds since unix)
$d = New-Object System.DateTime(1970, 1, 1, 0, 0, 0, 0 )
$d.AddSeconds(1516884006)

# Check Token Validity
# https://stackoverflow.com/questions/36724793/passport-azure-ad-does-it-parse-validate-token
# https://stormpath.com/blog/nodejs-jwt-create-verify
# https://nicksnettravels.builttoroam.com/post/2017/01/24/Verifying-Azure-Active-Directory-JWT-Tokens.aspx  (<---- )
# https://stackoverflow.com/questions/42018521/validating-signature-of-jwt-in-azure-ad-b2c-with-nodejs?rq=1

# Bearer Strategy Sample (Does not Work)
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-devquickstarts-webapi-nodejs

# Example OIDCStrategy
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-v2-devquickstarts-node-web


#  use MSAL.JS for V2.0 endpoints
# https://docs.microsoft.com/en-us/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa

# The MSAL Library
# https://github.com/AzureAD/microsoft-authentication-library-for-js

# Video
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-appmodel-v2-overview

# Dev Guide
# http://aka.ms/aadv2
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-appmodel-v2-overview
# Register v2 apps here:
# http://apps.dev.microsoft.com
# Kirk Evans NodeJs and AzureAD walkthrough using passport-azure-ad
# https://blogs.msdn.microsoft.com/kaevans/2017/03/10/creating-a-node-js-application-secured-by-azure-ad/

# Intro on Microsoft Flows Tokens and more The Basics (Read!)
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-protocols-openid-connect-code

# PnP-JS-Core  OLD
# https://github.com/SharePoint/PnP-JS-Core
# https://github.com/SharePoint/PnP-JS-Core/wiki/Configuration
# https://github.com/SharePoint/PnP/blob/dev/Samples/SharePoint.pnp-js-core/SharePoint.pnp-js-core/Samples/AddListAndItem.html

# PnPJSCore New Verions 
# https://pnp.github.io/pnpjs/
# https://pnp.github.io/pnpjs/nodejs/index.html
# https://pnp.github.io/pnpjs/nodejs/sp-fetch-client.html

# NodeJs Express and Passport Session Management Deep Dive
# https://www.airpair.com/express/posts/expressjs-and-passportjs-sessions-deep-dive

# Node Session Module
# https://www.npmjs.com/package/express-session

# Routing Module
# https://scotch.io/tutorials/learn-to-use-the-new-router-in-expressjs-4

# Access Taxonomy with nodejs / csom (There ist NO REST Interface !!!)
# https://www.linkedin.com/pulse/working-sharepoint-mmd-nodejs-andrew-koltyakov
# https://www.npmjs.com/package/csom-node (Does not work in ExpressJS)

# Request-Promise
# https://github.com/request/request-promise

# App permisson and consent framework
# https://docs.microsoft.com/en-us/azure/active-directory/active-directory-apps-permissions-consent

# Azure App only certificate example
# https://docs.microsoft.com/en-us/sharepoint/dev/solution-guidance/security-apponly-azuread

# Discovery Service
# https://msdn.microsoft.com/en-us/office/office365/api/discovery-service-rest-operations

# AddIn Permission request scope
# https://docs.microsoft.com/en-us/sharepoint/dev/sp-add-ins/authorization-code-oauth-flow-for-sharepoint-add-ins

# Create a queue triggered function app
# https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-storage-queue-triggered-function

# MEAN Stack Example
# https://www.djamware.com/post/5a0673c880aca7739224ee21/mean-stack-angular-5-crud-web-application-example
# https://github.com/didinj/mean-stack-angular5-crud

# Debugging in VS Code
# https://johnpapa.net/debugging-with-visual-studio-code/
# https://code.visualstudio.com/docs/nodejs/nodejs-debugging
# https://code.visualstudio.com/docs/editor/debugging

# Azure and NodeJS ***
# https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-nodejs-how-to-use-queues

# Angular async pipe example
# https://www.concretepage.com/angular-2/angular-2-async-pipe-example

# Flow and SiteScript example for provisioning a site through PowerShell and an Azure Function App
# https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/site-design-pnp-provisioning

# Remote Provisioning with PnP Core / Paolo Pialorsi
# https://docs.microsoft.com/en-us/sharepoint/dev/solution-guidance/pnp-remote-provisioning

# Deploy a Node.js application to Azure (Azure CLI or directly from VS Code)    ***
# https://code.visualstudio.com/docs/nodejs/nodejs-deployment

# Create a modern Site REST (PnP)   ****
# https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Modern.Console.RESTAPI

# RXJS Docs
# http://reactivex.io/rxjs/manual/overview.html
# https://toddmotto.com/rxjs-observables-observers-operators

# Function App get context information
# https://github.com/Azure/azure-functions-host/wiki/Retrieving-information-about-the-currently-running-function

# Form with select / options and defaults
# https://www.concretepage.com/angular-2/angular-2-select-option-multiple-select-option-validation-example-using-template-driven-form

# Use Components in template driven forms
# https://stackoverflow.com/questions/45659742/angular4-no-value-accessor-for-form-control
# https://blog.thoughtram.io/angular/2016/07/27/custom-form-controls-in-angular-2.html
# https://coryrylan.com/blog/angular-custom-form-controls-with-reactive-forms-and-ngmodel

# Bootstrap
# https://getbootstrap.com/docs/3.3/css/

# Teams API (!)
# https://blog.thoughtstuff.co.uk/2017/07/how-to-manage-microsoft-teams-send-messages-using-the-teams-api-in-microsoft-graph/

# Site provisioning Web Part Angular, pre beta, but extrem cool
# https://github.com/sebastienlevert/spfx-ng-webparts

# MongoDB / CosmosDB
# https://docs.microsoft.com/en-us/azure/cosmos-db/mongodb-introduction
# https://docs.microsoft.com/en-us/azure/cosmos-db/create-mongodb-nodejs

# Single Sign Out
# https://hajekj.net/2017/02/27/to-single-sign-out-or-not-to/

# VSTS Ci with Node JS
# https://docs.microsoft.com/en-us/vsts/build-release/archive/apps/nodejs/nodejs-to-azure
# CD the Build
# https://docs.microsoft.com/en-us/vsts/build-release/apps/cd/deploy-webdeploy-webapps
# https://docs.microsoft.com/de-ch/vsts/build-release/concepts/library/service-endpoints#sep-azure-rm

# Graph API operations on users
# https://msdn.microsoft.com/en-us/library/azure/ad/graph/api/users-operations
# Supported filters and queries
# https://msdn.microsoft.com/en-us/library/azure/ad/graph/howto/azure-ad-graph-api-supported-queries-filters-and-paging-options

# Graph API with Node
# https://developer.microsoft.com/en-us/graph/docs/concepts/nodejs      Sample:
# https://github.com/microsoftgraph/nodejs-connect-rest-sample
#
# Javascript API
# https://github.com/microsoftgraph/msgraph-sdk-javascript
# Typescript Types
# https://github.com/microsoftgraph/msgraph-typescript-typings

# Keyvault
# https://docs.microsoft.com/en-us/rest/api/keyvault/about-keys--secrets-and-certificates
# https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest#az_keyvault_create
# https://docs.microsoft.com/en-us/azure/key-vault/key-vault-get-started
# https://docs.microsoft.com/en-us/azure/key-vault/vs-secure-secret-appsettings

# Azure Key Vault REST
# https://docs.microsoft.com/en-us/rest/api/keyvault/
# https://docs.microsoft.com/en-us/rest/api/keyvault/authentication--requests-and-responses

# REST Resource Uri Identifier
# https://docs.microsoft.com/en-us/rest/api/#create-the-request

# Finally here (Its Resource: {resource: 'https://vault.azure.net'}
# https://azure.microsoft.com/en-us/resources/samples/app-service-msi-keyvault-node/ 

# Keyvault and Powershell
# https://blogs.msdn.microsoft.com/cclayton/2017/01/02/using-key-vault-secrets-in-powershell/

# VSTS Build and Release Management
# https://docs.microsoft.com/en-us/vsts/build-release/concepts/definitions/release/what-is-release-management

# adal-node
# https://github.com/AzureAD/azure-activedirectory-library-for-nodejs

# Use Key Vault from App Service with Managed Service Identity and Nodejs
# https://azure.microsoft.com/en-au/resources/samples/app-service-msi-keyvault-node/
# https://github.com/Azure-Samples/app-service-msi-keyvault-dotnet
# https://docs.microsoft.com/en-us/azure/app-service/app-service-managed-service-identity

# use together with azure-keyvault (Managed Service Identity)
# https://github.com/Azure-Samples/app-service-msi-keyvault-node/blob/master/index.js

# Pre Start initialization (express-init did not work, inits does perfectly)
# https://www.npmjs.com/package/inits

# Logging on Azure
# http://geeklearning.io/nodejs-logging-with-bunyan-and-azure/

# Bootstrap 4 Angular
# https://ng-bootstrap.github.io/#/getting-started

# Powershell PnP Provisioning and  Theming (Color Scheme)
# http://sharepoint.handsontek.net/2017/12/05/change-the-color-of-sharepoint-modern-experience-automatically/
# http://sharepoint.handsontek.net/2018/03/11/brand-modern-sharepoint-online-sites/
# https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/site-theming/sharepoint-site-theming-powershell
# https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/site-theming/sharepoint-site-theming-overview
# https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/site-theming/sharepoint-site-theming-powershell#getting-started

# Get Sub terms with PnP (!) From: https://sharepoint.stackexchange.com/questions/229823/get-child-terms-of-a-particular-taxonomy-term-using-csom
# $t = Get-PnPTerm -TermGroup SiteProvisioning  -TermSet Zweck -Identity "Produkte und Kundenbeziehungen"
# $c = $t.Context
# $c.Load($t.Terms)
# $c.ExecuteQuery()
# $t.Terms
# -> All Sub Terms are there

# NodeJs Event Loop Timers and Process.nexttick
# https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/

# OAuth2 On Behalf of Stuff
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-integrating-applications
# Difference between Delegated and App Permissions
# https://docs.microsoft.com/en-us/azure/active-directory/application-dev-delegated-and-app-perms

# https://msftstack.wordpress.com/2016/01/03/how-to-call-the-azure-resource-manager-rest-api-from-c/
# http://paulryan.com.au/2017/oauth-on-behalf-of-flow-adal/   On Behalf of
# https://github.com/Azure-Samples/active-directory-dotnet-webapi-onbehalfof       <---- Has a full Sample of onBehalfOf,...
# Decription of the on behalf of flow (V2):
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of
# Decription of the on behalf of flow (V1):
# https://docs.microsoft.com/de-ch/azure/active-directory/develop/active-directory-protocols-oauth-on-behalf-of
# Get token for client app
# https://docs.microsoft.com/en-us/rest/api/datacatalog/authenticate-a-client-app
# App only tokens
# https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-protocols-oauth-service-to-service

# Node and Azure und IIS iisnode
# https://mspi.es/blog/iisnode.yml-Konfigurieren-von-Node.js-in-Windows-Azure

# This explains that iisnode.yml does NOT change what Kudu does (!)  
# https://blogs.msdn.microsoft.com/azureossds/2016/04/20/nodejs-and-npm-versions-on-azure-app-services/

# Custom Deployment Scripts KUDU
# https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script

# Teams enable a Group (currently BETA)
# https://www.techmikael.com/2017/11/programmatically-enable-teams-on-office.html
# https://developer.microsoft.com/en-us/graph/docs/api-reference/beta/api/group_put_team
# Get classsifications:
# https://developer.microsoft.com/en-us/graph/docs/api-reference/beta/api/directorysetting_list
# REST API Graph Groups et al
# https://msdn.microsoft.com/de-de/library/azure/ad/graph/api/groups-operations
# https://msdn.microsoft.com/de-de/library/azure/ad/graph/howto/azure-ad-graph-api-supported-queries-filters-and-paging-options
# https://developer.microsoft.com/en-us/graph/docs/api-reference/beta/api/group_update

# OAuth / openIDConnect with Group Claims
# https://github.com/Azure-Samples/active-directory-dotnet-webapp-groupclaims

# Storage Queue Messages
# https://docs.microsoft.com/en-us/rest/api/storageservices/queue-service-rest-api

# Angular Directive restricted input
# https://stackoverflow.com/questions/45072369/how-to-restrict-special-characters-in-the-input-field-using-angular2-typescript

# Keycode Table
# https://www.mediaevent.de/javascript/Extras-Javascript-Keycodes.html

# Update Classification (s)  Group + Site !
# http://sadomovalex.blogspot.com/2018/05/set-o365-group-classification-via-graph.html

# Set O365 Labels by Code ( CSOM / finally, not tested yet )
# http://www.myfatblog.co.uk/index.php/2018/05/configuring-default-office-365-labels-using-powershell/

# Using Markdown in GIT
# https://guides.github.com/features/mastering-markdown/
# https://docs.microsoft.com/en-us/vsts/project/wiki/markdown-guidance?view=vsts
